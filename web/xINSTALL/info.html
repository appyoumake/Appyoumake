<!DOCTYPE html>
<html>
<!--
@copyright Copyright (c) 2013-2016, Norwegian Defence Research Establishment (FFI) - All Rights Reserved
@license Proprietary and confidential
@author Arild Bergh/Sinett 3.0 programme (firstname.lastname@ffi.no)
@author Cecilie Jackbo Gran/Sinett 3.0 programme (firstname.lastname@ffi.no)

Unauthorized copying of this file, via any medium is strictly prohibited 

For the full copyright and license information, please view the LICENSE_MLAB file that was distributed with this source code.
-->
    <head>
        <meta http-equiv=Content-Type content="text/html; charset=utf-8">
        <link rel="stylesheet" type="text/css" href="info.css">
    </head>
<!--body -->
    <body>
<!--internet_present-->
        <h1 class="nocounter">Mlab server setup</h1>
        <p>Before you can use Mlab you need to install the source code on a correctly configured webserver. Mlab is primarily tested on Linux, but there are no inherent Linux features required, as long as your operating system supports the requirements below you should be able to run it.</p>
        <p>Mlab can be run without an Internet connection, but during installation of the server software a connection is required. Verify your Internet connection and rectify any issues before continuing.</p>
        <p>There are four main steps involved in preparing Mlab:</p>
        <ol>
            <li>Install server software such as web server, database server, PHP, etc.</li>
            <li>Create a directory (folder) for Mlab and copy the source code into this directory.</li>
            <li>Configure the various server software and helper software (where required) to match the Mlab directory location.</li>
            <li>Run the Mlab installation script which will verify that the setup is correct and perform certain actions that will complete the setup.  
                <ol type='a'> 
                    <li>The steps required are described in this document under the “<a href="#_5:_(Optional)_Install">Install Mlab manually</a>”  section toward the end of the document.</li>
                </ol>
            </li>
            <li>Optionally you can install the Mlab compiler service, this is documented in <a href="info_cs.html">the Mlab compiler service installation document</a> </li>
        </ol>
        <p><i>All examples in this document use a generic Debian/Ubuntu installation, thus all examples refer to apt-get as the package manager. Other Linux distributions may use rpm, yum or other package managers, modify the commands as required. On Windows there is no package manager. For each software installation you need to download the relevant software package and run the executable installer.</i></p>
        <p class="important">
            To install Mlab you need to be familiar with website setup in general, this includes knowledge about domains/host names/IP addresses and ports; manipulating files, folders and access permissions; editing plain text scripts and configuration files and issuing commands on the command line.
        </p>

        <h1>Install server and helper software</h1>
        <p>Here we go through the installation of servers and related software that Mlab requires to operate correctly. This section only deals with the actual installation of the software, <b>notes on how to configure the servers to work with Mlab are given in <a href="#_3:_Configuration">step 3</a>.</b></p>
        <p>If you are setting up a development machine and not a live server, you may want to use the XAMPP package. This includes almost everything that Mlab requires and needs only a minimal installation. You can download this from <a href="https://www.apachefriends.org/index.html">here</a> and skip to step <a href="#_1.4_Install_NodeJS_npm_and_uglifyjs">1.4</a> </p>

        <h2>Install web server</h2>
        
        
        <h3>Specify host & domain name, test web server</h2>
        <p>In this documentation <em>{mlab_url}</em> will be used to denote the URL used for Mlab. A number of configuration files require this for Mlab to work correctly. The URL is made up of a host and domain name. To provide details on domain name setup is beyond the scope of this documentation, however we recommend following these steps:</p> 
        <ul>
            <li>Search online for how to set up domain/host names for your chosen operating system.</li>
            <li>Update relevant settings/files on your server</li>
            <li>Point your web browser to the domain name you have configured the server for (http://{mlab_url}) to test that it's working. You either see a sample page, or a 404 warning as Mlab is not fully installed yet.</li>
        </ul>

        <p class="important">After this is done, make a note of the full URL and use this whenever we refer to <em>{mlab_url}</em> below.</p> 
        
        <p>Choose which web server you want to use that supports integration with PHP. Apache 2.x and Nginx have been tested, however, Mlab will work with any other web server that supports PHP and URL rewriting, such as Lighttpd.</p>

        <h3>Alternative 1: Install Apache</h3>
        
        <div class="tab">
            <button class="tablinks111 defaultOpen" onclick="openTab(event, 'Debian', '111')">Ubuntu 14.04</button>
            <button class="tablinks111" onclick="openTab(event, 'Windows', '111')">Windows</button>
            <button class="tablinks111" onclick="openTab(event, 'Mac', '111')">Mac</button>
            <button class="tablinks111" onclick="openTab(event, 'OtherLinux', '111')">Linux/Unix/BSD variants</button>
        </div>

        <div id="Debian111" class="tabcontent tabcontent111">
            <p>Run the following commands:</p>

            <pre>apt-get install apache2</pre>
            <pre>service apache2 start</pre>
            
            <p>Relevant link: <a href="http://httpd.apache.org/docs/current/install.html">http://httpd.apache.org/docs/current/install.html</a></p>
        </div>

        <div id="Windows111" class="tabcontent tabcontent111">
            <p>For Windows refer to these notes for Apache: <a href="https://httpd.apache.org/docs/current/platform/windows.html">https://httpd.apache.org/docs/current/platform/windows.html</a></p> 
        </div>

        <div id="Mac111" class="tabcontent tabcontent111">
            <p>On many MacOSX versions Apache is already installed. If not, there are many guides to using Apache on the macOS. A recent and very complete guide can be found here: <a href="https://coolestguidesontheplanet.com/get-apache-mysql-php-and-phpmyadmin-working-on-macos-sierra/">Install Apache, MySQL, PHP and phpMyAdmin on macOS Sierra</a></p>
        </div>
        
        <div id="OtherLinux111" class="tabcontent tabcontent111">
            <p>Apache is often preinstalled on Linux, if so you can skip this step. If not install on Linux using your package manager and install the relevant package, examples using RPM can be found here: <a href="https://httpd.apache.org/docs/current/platform/rpm.html">Using Apache With RPM Based Systems (Redhat / CentOS / Fedora)</a>.</p>
        </div>
        

        <h3>Alternative 2: Install Nginx</h3>
        
        <div class="tab">
            <button class="tablinks112 defaultOpen" onclick="openTab(event, 'Debian', '112')">Ubuntu 14.04</button>
            <button class="tablinks112" onclick="openTab(event, 'Windows', '112')">Windows</button>
            <button class="tablinks112" onclick="openTab(event, 'Mac', '112')">Mac</button>
            <button class="tablinks112" onclick="openTab(event, 'OtherLinux', '112')">Linux/Unix/BSD variants</button>
        </div>

        <div id="Debian112" class="tabcontent tabcontent112">
            <p>Apache2 may be installed by default, if so you need to remove it.</p>
            <pre>service apache2 stop</pre>
            <pre>update-rc.d -f apache2 remove</pre>
            <pre>apt-get remove apache2</pre>

            <p>Then install nginx using these commands:</p>
            <pre>sudo apt-get install nginx</pre>
            <pre>sudo service nginx start</pre>

            <p>Relevant link: <a href="https://www.howtoforge.com/installing-nginx-with-php5-fpm-and-mysql-on-ubuntu-14.04-lts-lemp">https://www.howtoforge.com/installing-nginx-with-php5-fpm-and-mysql-on-ubuntu-14.04-lts-lemp</a></p>
       </div>

        <div id="Windows112" class="tabcontent tabcontent112">
             <p>For Windows follow these notes: <a href="http://nginx.org/en/docs/windows.html">nginx for Windows</a>./p>
        </div>

        <div id="Mac112" class="tabcontent tabcontent112">
            <p>On Mac based computers you can follow these instructions: <a href="https://coderwall.com/p/dgwwuq/installing-nginx-in-mac-os-x-maverick-with-homebrew">https://coderwall.com/p/dgwwuq/installing-nginx-in-mac-os-x-maverick-with-homebrew</a></p>
        </div>
        
        <div id="OtherLinux112" class="tabcontent tabcontent112">
            <p>Most other Linux distributions have packages available for nginx, see <a href="https://www.nginx.com/resources/wiki/start/topics/tutorials/install/">official nginx pages for more information</a>.</p>
        </div>

        
<!--version_php-->
        <h2>Install PHP</h2>
        <p>PHP 5.4+ or higher is required for the Mlab server. Mlab has been tested with PHP versions 5.6, 7.0 and 7.2</p>
        <p>You can install PHP as a CGI, CLI or FPM process, we recommend FPM that runs a <a href="https://php-fpm.org/">FastCGI Process Manager</a>  server (for performance reasons). The examples here discuss installing the FPM version, if you use another type you must adjust the commands accordingly.</p>
        <div class="tab">
            <button class="tablinks121 defaultOpen" onclick="openTab(event, 'Debian', '121')">Ubuntu 14.04</button>
            <button class="tablinks121" onclick="openTab(event, 'Windows', '121')">Windows</button>
            <button class="tablinks121" onclick="openTab(event, 'Mac', '121')">Mac</button>
            <button class="tablinks121" onclick="openTab(event, 'OtherLinux', '121')">Linux/Unix/BSD variants</button>
        </div>

        <div id="Debian121" class="tabcontent tabcontent121">
            <pre>sudo apt-get install php5-common php5-cli php5-fpm</pre>
            <p>php5-fpm runs a FastCGI server on the socket /var/run/php5-fpm.</p>
        </div>

        <div id="Windows121" class="tabcontent tabcontent121">
            <p>Information on an Windows installation can be found at the official PHP pages: <a href="http://php.net/manual/en/install.windows.php">Installation on Windows systems</a></p>
        </div>

        <div id="Mac121" class="tabcontent tabcontent121">
            <p>Many versions of MacOSX have PHP already installed. Information on an MacOS installation can be found at the official PHP pages: <a href="http://php.net/manual/en/install.macosx.php">Installation on Mac OS X</a></p>
        </div>
        
        <div id="OtherLinux121" class="tabcontent tabcontent121">
            <p>Most Linux varieties have PHP 5.x as a package in their repositories so you can install it using your preferred package manager. Otherwise refer to the official PHP pages: <a href="http://php.net/manual/en/install.unix.php">Installation on Unix systems</a></p>
        </div>
<!--/version_php-->
<!--libraries_php-->
        <h3>Install required PHP extensions</h3>
        <p>Next you need to install a number of PHP extensions that provides additional functionality that Mlab depends on. Some of these may already be installed as part of the core PHP installation.</p>
        <p><b>The actual package names may vary between different operating systems and different versions of PHP and/or operating systems/distributions, please refer to your particular operating system.</b></p>
        <p><b><i>Please also remember you may need to restart PHP and/or HTTP services for changes to take effect.</i></b></p>
        <p>The extensions required are: 
            <ul class="columns" style="width: 700px; display: block; margin-bottom: 20px;">
                <li>curl</li>
                <li>dom</li>
                <li>fileinfo</li>
                <li>gd</li>
                <li>gettext</li>
                <li>iconv</li>
                <li>intl</li>
                <li>json</li>
                <li>libxml</li>
                <li>mbstring</li>
                <li>mysqli</li>
                <li>openssl</li>
                <li>pcre</li>
                <li>pdo_mysql</li>
                <li>phar</li>
                <li>readline</li>
                <li>session</li>
                <li>simplexml</li>
                <li>soap</li>
                <li>sockets</li>
                <li>xml</li>
                <li>xmlreader</li>
                <li>xmlwriter</li>
                <li>zip</li>
            </ul>
        </p>
        <div style="width: 100%; display: block; clear: both; height: 20px; float: left;"></div>
        <div class="tab">
            <button class="tablinks122 defaultOpen" onclick="openTab(event, 'Debian', '122')">Ubuntu 14.04</button>
            <button class="tablinks122" onclick="openTab(event, 'Windows', '122')">Windows</button>
            <button class="tablinks122" onclick="openTab(event, 'Mac', '122')">Mac</button>
            <button class="tablinks122" onclick="openTab(event, 'OtherLinux', '122')">Linux/Unix/BSD variants</button>
        </div>

        <div id="Debian122" class="tabcontent tabcontent122">
            <p>You can use the standard package manager to install these. </p>
            <pre>sudo apt-get install php5-gd php5-intl php5-json php5-mcrypt php5-mysql php5-readline php-gettext php-pear php-xml-dtd php-xml-htmlsax3 php-xml-parser php-xml-rpc php-xml-rpc2 php-xml-rss php-xml-serializer</pre>
        </div>

        <div id="Windows122" class="tabcontent tabcontent122">
            <p>You can use the <a href="http://php.net/manual/en/install.pecl.windows.php">PHP Extension Community Library (PECL)</a> repository to install these extensions on Windows.</p>
        </div>

        <div id="Mac122" class="tabcontent tabcontent122">
            <p>As with Windows you can install the <a href="https://jason.pureconcepts.net/2012/10/install-pear-pecl-mac-os-x/">PHP Extension Community Library (PECL)</a> repository to install these extensions.</p>
        </div>
        
        <div id="OtherLinux122" class="tabcontent tabcontent122">
            <p>Most Linux and Unix distributions will have the required extensions in their repositories, please refer to relevant documentation to find the correct packages to install.</p>
        </div>
        <p>The Mlab installation script will check if any of these libraries are missing later.</p>
<!--/libraries_php-->

<!--python-->
        <h2>Install Python and Libreoffice</h2>
        <p>Mlab supports the import of Microsoft PowerPoint and Word files into Mlab apps. This is done by using <a href="https://github.com/dagwieers/unoconv">Unoconv</a>, a Python script which uses Libreoffice to convert from PPT/DOC files to HTML files. A small Mlab Python script is then used to add the resulting HTML output as individual pages to the app you are working on. To enable this you need to install the following software:</p>
        <ul>
            <li>Libreoffice</li>
            <li>python (tested with version 2.7)</li>
            <li>python modules
                <ul>
                    <li>argparse (tested with version 1.1)</li>
                    <li>json, 2.0.9</li>
                    <li>python-magic</li>
                    <li>python-bs4</li>
                </ul>
            </li>
        </ul>
        <div style="width: 100%; display: block; clear: both; height: 20px; float: left;"></div>
        <div class="tab">
            <button class="tablinks140 defaultOpen" onclick="openTab(event, 'Debian', '140')">Ubuntu 14.04</button>
            <button class="tablinks140" onclick="openTab(event, 'Windows', '140')">Windows</button>
            <button class="tablinks140" onclick="openTab(event, 'Mac', '140')">Mac</button>
            <button class="tablinks140" onclick="openTab(event, 'OtherLinux', '140')">Linux/Unix/BSD variants</button>
        </div>

        <div id="Debian140" class="tabcontent tabcontent140">
            <p>You can use the standard package manager to install the Python and Libreoffice. </p>
            <pre>sudo apt-get install python libreoffice-writer libreoffice-calc libreoffice-script-provider-python</pre>
        </div>

        <div id="Windows140" class="tabcontent tabcontent140">
            <p>Installation files for Windows can be downloaded from <a href="https://www.python.org/downloads/windows/">the Python website</a> and <a href="https://www.libreoffice.org/download/download/">the Libreoffice website</a></p>
        </div>

        <div id="Mac140" class="tabcontent tabcontent140">
            <p>As with Windows you can install Python from installation files downloadable from <a href="https://www.python.org/downloads/mac-osx/">the Python website</a>; Libreoffice you get from the <a href="https://www.libreoffice.org/download/download/">official Libreoffice website</a>.</p>
        </div>
        
        <div id="OtherLinux140" class="tabcontent tabcontent140">
            <p>Most Linux and Unix distributions will have the required packages in their repositories, please refer to relevant documentation to find the correct packages to install.</p>
        </div>
        
        <p>To install the libraries you should use the PIP package manager, details on how to do this can be found on the <a href="https://packaging.python.org/tutorials/installing-packages/">official Python website</a>.</p>
        
<!--/python-->


<!--version_mysql-->
        <h2>Install database server</h2>
        <p>Mlab should work with any database server supported by the <a href="http://www.doctrine-project.org/projects/orm.html">Doctrine ORM</a> library. In the example here we refer to MySQL 5.x as it has been tested with Mlab. <a href="https://mariadb.org/">MariaDB</a> is a drop-in replacement for MySQL and should also work without problems.<p>
         <div class="tab">
            <button class="tablinks131 defaultOpen" onclick="openTab(event, 'Debian', '131')">Ubuntu 14.04</button>
            <button class="tablinks131" onclick="openTab(event, 'Windows', '131')">Windows</button>
            <button class="tablinks131" onclick="openTab(event, 'Mac', '131')">Mac</button>
            <button class="tablinks131" onclick="openTab(event, 'OtherLinux', '131')">Linux/Unix/BSD variants</button>
        </div>

        <div id="Debian131" class="tabcontent tabcontent131">
            <p>MySQL might be pre-installed, if not you need to run the following commands:</p>
            <pre>apt-get install mysql-server mysql-client </pre>
        </div>

        <div id="Windows131" class="tabcontent tabcontent131">
            <p>Follow instructions <a href="https://dev.mysql.com/doc/refman/5.7/en/windows-installation.html">here</a> to find out how to install the Windows version of MySQL.</p>
        </div>

        <div id="Mac131" class="tabcontent tabcontent131">
            <p>For complete instructions look at the <a href="https://dev.mysql.com/doc/refman/5.7/en/osx-installation.html">MySQL documentation for MacOSX.</a></p>
        </div>
        
        <div id="OtherLinux131" class="tabcontent tabcontent131">
            <p>MySQL is usually available in your distribution's repository, if not you can look at the <a href="https://dev.mysql.com/doc/refman/5.7/en/binary-installation.html">official installation instructions</a> for some guidance.</p>
        </div>
        
        <p>You will be asked to set the password for the root user, make a note of this for later.</p>
<!--/version_mysql-->
        
<!--version_nodejs-->
<!--version_uglifyjs-->
        <h2><a name="_1.4_Install_NodeJS_npm_and_uglifyjs"></a>Install Composer, NodeJS, npm and uglifyjs</h2>
        
<!--version_composer-->
        <h3 >Installing Composer</h3>
        <p> Composer is a package manager for PHP. It is used to install the Symfony framework that Mlab uses on the server side. Follow the instructions on the <a href="https://getcomposer.org/download/">official Composer download page</a> to install it.</p>
<!--/version_composer-->
        
        <h3 >Installing NodeJS & npm</h3>
        <p>NodeJS is used for a small Websockets server, this is required to talk to other Mlab services such as the app compilation service. Additionally, UglifyJS is used to protect the front end source code from copying. Without this protection Mlab will not run.</p>
        <div class="tab">
            <button class="tablinks141 defaultOpen" onclick="openTab(event, 'Debian', '141')">Ubuntu 14.04</button>
            <button class="tablinks141" onclick="openTab(event, 'Windows', '141')">Windows</button>
            <button class="tablinks141" onclick="openTab(event, 'Mac', '141')">Mac</button>
            <button class="tablinks141" onclick="openTab(event, 'OtherLinux', '141')">Linux/Unix/BSD variants</button>
        </div>

        <div id="Debian141" class="tabcontent tabcontent141">
            <p>If NodeJS or npm are not installed you need to run the following command to install the relevant packages:</p>
            <pre>apt-get install nodejs npm</pre>
        </div>

        <div id="Windows141" class="tabcontent tabcontent141">
            <p>NodeJS and NPM are available as downloadable packages, for installation details see <a href="http://blog.teamtreehouse.com/install-node-js-npm-windows">here</a>.</p>
        </div>

        <div id="Mac141" class="tabcontent tabcontent141">
            <p>Mac users can follow the instructions <a href="https://coolestguidesontheplanet.com/installing-node-js-on-macos/">here</a> on how to install NodeJS/npm.</p>
        </div>
        
        <div id="OtherLinux141" class="tabcontent tabcontent141">
            <p>There are packages available for most Linux/Unix based OSes, official details are on <a href="https://nodejs.org/en/download/package-manager/">the NodeJS website</a>.</p>
        </div>
        
        <h3 >Installing UglifyJS</h3>
        <p>After npm is installed you can use npm to install UglifyJS.</p>
        <div class="tab">
            <button class="tablinks141 defaultOpen" onclick="openTab(event, 'Debian', '142')">Ubuntu 14.04, Windows, Mac and Linux/Unix/BSD variants</button>
        </div>

        <div id="Debian142" class="tabcontent tabcontent142">
            <p>If npm is correctly installed this will be the same command on all operating systems:</p>
            <pre>sudo npm install uglify-js -g</pre>
        </div>
        <p>The “-g” parameter is important, without this uglifyjs will be installed in the current directory, it needs to be installed “globally” so it can be used by Mlab later. <strong>You may need to run this command as root/administrator user to work correctly.</strong></p>
        
<!--/version_nodejs-->
<!--/version_uglifyjs-->

<!--source_code-->
        <h1>Install Mlab sources</h1>
        <p>After installing the servers and helper software in step 1, you need to copy over the Mlab source code. </p>
        <p class="important">
            To complete this section you need to be familiar with manipulating files, folders and access permissions on your chosen operating system.
        </p>
<!--directories-->
        <h2><a name="2_1"></a>Create directories/folders for Mlab</h2>
        <p>First create a new directory in a suitable location for your OS/Web server. On Linux this is often /var/www, refer to your OS information where is the best location for this. Below we will use the placeholder <em>{mlab_code}</em> for this folder. You will also need to create another folder for the elements that make up an app and the apps themselves (apps, components, icons and templates), below we will use the placeholder <em>{mlab_elements}</em> for these directories.</p>
        <p class="important">The placeholders used here should be replaced by directory names that are appropriate to your setup. For example, {mlab_code} could be something like <em>/var/www/mlab</em> and you may use <em>/srv/www/mlab_elements</em> for {mlab_elements}. You MUST make sure that the directory used for accessible via a URL that shares the domain of the main site, this must be configured in your web server, AND in the “urls” settings in the next section of this file.</p>
        <p>Create the following directories:</p>
        <div class="tab">
            <button class="tablinks21 defaultOpen" onclick="openTab(event, 'Debian', '21')">Ubuntu 14.04, Mac and Linux/Unix/BSD variants</button>
            <button class="tablinks21" onclick="openTab(event, 'Windows', '21')">Windows</button>
        </div>      
        <div id="Debian21" class="tabcontent tabcontent21">
            <pre>sudo mkdir {mlab_code}<br>sudo mkdir {mlab_elements}<br>sudo mkdir {mlab_elements}/apps/<br>sudo mkdir {mlab_elements}/components/<br>sudo mkdir {mlab_elements}/templates/<br>sudo mkdir {mlab_elements}/icons/</pre>
        </div>
        <div id="Windows21" class="tabcontent tabcontent21">
            <pre>mkdir {mlab_code}<br>mkdir {mlab_elements}<br>mkdir {mlab_elements}/apps/<br>mkdir {mlab_elements}/components/<br>mkdir {mlab_elements}/templates/<br>mkdir {mlab_elements}/icons/</pre>
        </div>
<!--/directories-->
        <h2>Install Mlab source code</h2>
        <p>Next get your Mlab zip file, typically named something like mlab-v.0.9.0.zip (the actual filename will vary depending on the version you install). Unzip it inside the new directory using the relevant utility for your operating system. </p>
        <p>Make sure that the Mlab code is inside the root of the directory you created, you should see something similar to this (over time files/directories may be added, renamed or removed):></p> 
        <pre>
.
├── app
├── bin
├── composer.json
├── composer.lock
├── docs
├── LICENSE
├── LICENSE_MLAB
├── _minimal_websocket
├── mlab_elements
├── nbproject
├── README.md
├── robots.txt
├── src
├── test
├── vendor
└── web            
        </pre>        
        <p>If the unzip process has created a single sub-directory inside the Mlab directory you must move the files from the sub-directory and into the main Mlab directory.</p>
        
      
<!--version_symfony-->
        <h2>Complete Symfony installation</h2>
        <p> At this stage the composer package manager will be used to install the Symfony framework, Symfony libraries and some Javascript libraries used by Mlab on the front end. The commands below are the same for all operating systems. <b>You may need to run them as an administrative/root user.</b></p>
        <pre>cd /{mlab_code}/</pre>
        <pre>bin/composer.phar install</pre>
        <p>This will </p>
        <ul>
<!--libraries_symfony-->
            <li>Install the Symfony framework and the following, required libraries (if some are missing try to install manually using composer and check any error messages for clues as to what is missing):
                <ul class="columns" style="width: 700px; display: inline-block; padding-bottom: 20px; margin-left: -32px;">
                    <li>doctrine/annotations</li>
                    <li>doctrine/cache</li>
                    <li>doctrine/collections</li>
                    <li>doctrine/common</li>
                    <li>doctrine/dbal</li>
                    <li>doctrine/doctrine-bundle</li>
                    <li>doctrine/doctrine-cache-bundle</li>
                    <li>doctrine/inflector</li>
                    <li>doctrine/instantiator</li>
                    <li>doctrine/lexer</li>
                    <li>doctrine/orm</li>
                    <li>friendsofsymfony/user-bundle</li>
                    <li>gedmo/doctrine-extensions</li>
                    <li>incenteev/composer-parameter-handler</li>
                    <li>ircmaxell/password-compat</li>
                    <li>jdorn/sql-formatter</li>
                    <li>kriswallsmith/assetic</li>
                    <li>monolog/monolog</li>
                    <li>paragonie/random_compat</li>
                    <li>psr/log</li>
                    <li>sensio/distribution-bundle</li>
                    <li>sensio/framework-extra-bundle</li>
                    <li>sensio/generator-bundle</li>
                    <li>sensiolabs/security-checker</li>
                    <li>swiftmailer/swiftmailer</li>
                    <li>symfony/assetic-bundle</li>
                    <li>symfony/monolog-bundle</li>
                    <li>symfony/polyfill-apcu</li>
                    <li>symfony/polyfill-intl-icu</li>
                    <li>symfony/polyfill-mbstring</li>
                    <li>symfony/polyfill-php54</li>
                    <li>symfony/polyfill-php55</li>
                    <li>symfony/polyfill-php56</li>
                    <li>symfony/polyfill-php70</li>
                    <li>symfony/polyfill-util</li>
                    <li>symfony/security-acl</li>
                    <li>symfony/swiftmailer-bundle</li>
                    <li>symfony/symfony</li>
                    <li>symfony/yaml</li>
                    <li>twig/extensions</li>
                    <li>twig/twig</li>
                    <li>willdurand/js-translation-bundle</li>
                </ul>
            </li>
<!--/libraries_symfony-->
            <li style="clear: both;">Create the parameters.yml file (in app/config) if it does not exist, using parameters.yml.dist as a template.</li>
            <li>Generate the cache in app/cache. You may need to correct permissions on the cache folder after running composer install, this is explained below</li>
        </ul>
        
        <p>Check that everything works OK and that versions of tools are correct by running this command (possibly as an administrative/root user):</p>
        <pre>php app/check.php</pre>

<!--bootstrap_symfony-->
        <p>If you get an error regarding  &quot;bootstrap.php.cache&quot; (missing,  etc), usually the case when starting or moving to new version of Symfony, run this from the root folder of Mlab site:</p>
        <pre>php ./vendor/sensio/distribution-bundle/Sensio/Bundle/DistributionBundle/Resources/bin/build_bootstrap.php  </pre>
        <p>See: <a href="http://stackoverflow.com/questions/6072081/symfony2-updating-bootstrap-php-cache">http://stackoverflow.com/questions/6072081/symfony2-updating-bootstrap-php-cache</a> for more information.</p>
<!--/bootstrap_symfony-->

<!--libraries_js-->
        <h2>Install JavaScript libraries</h2>
        <p>Mlab requires a number of jQuery JavaScript libraries. These are normally installed when you install the Symfony libraries. If they have not been installed you can run the command below to manually install them (you may need to do this as an administrator/root user).</p>
        <pre>cd /{mlab_code}/</pre>
        <pre>bin/composer.phar run-script post-install-cmd </pre>
<!--/libraries_js-->

<!--assetic_update-->
        <h2>Update the JavaScript assets</h2>
        <p class="important">It is a contractual obligation to use UglifyJS to protect the Javascript source in Mlab. To do this you need to generate a single combined "asset" JavaScript from the original code using the commands below (you may need to do this as an administrator/root user). <b>If you do not do this Mlab will fail to work.</b></p>
        <pre>cd /{mlab_code}/</pre>
        <pre>app/console --env=prod assetic:dump</pre>
        <pre>app/console --env=dev assetic:dump</pre>
<!--/assetic_update-->

        <p>Remove the {mlab_code}/app/.htaccess using the relevant command for your platform.</p>
<!--/version_symfony-->


<!--libraries_npm-->
        <h2>Install NodeJS Websocket library</h2>
        <p>The minimal websocket server used by the Mlab app editor to communicate with the Mlab compiler service requires the installation of the <em>websocket</em> library to run. This is done from the command line using the NodeJS package manager:</p>
        <pre>cd {mlab_code}/_minimal_websocket<br>npm install</pre>
<!--/libraries_npm-->

<!--directories-->
        <h2>Set access permissions</h2>
        <p>Set the right permissions to the directory you created. The owner of the Mlab directory and all files and directories inside the Mlab directory should       be the web server process/user. This is because Mlab will need to create files as users create apps or uploads new components, etc. </p>
        <p>In the text below the actual user name is indicated with <i>{webserveruser}</i>, you will need to replace this with the actual user name of your web server process user.</p>

        <div class="tab">
            <button class="tablinks23 defaultOpen" onclick="openTab(event, 'Debian', '23')">Ubuntu 14.04, Mac and Linux/Unix/BSD variants</button>
            <button class="tablinks23" onclick="openTab(event, 'Windows', '23')">Windows</button>
        </div>              
        <div id="Debian23" class="tabcontent tabcontent23">
            <pre>sudo chown {webserveruser}:{webserveruser} {mlab_code} -R<br>sudo chown {webserveruser}:{webserveruser} {mlab_elements} -R</pre>
        </div>
        <div id="Windows23" class="tabcontent tabcontent23">
            <p>As an administrative user run the following commands:</p>
            <pre>icacls "{mlab_code}" /grant {webserveruser}:(OI)(CI)F /T<br>icacls "{mlab_elements}" /grant {webserveruser}:(OI)(CI)F /TR</pre>
        </div>
<!--/directories-->
<!--/source_code-->

        <h1><a name="_3:_Configuration"></a>Server configuration</h1>

        <p>The server software installed in step 1. needs some additional configurations to be able to work with Mlab. Below you will find detailed instructions and examples for each of these servers. Replace {mlab_url} with the relevant URL for your server.</p>
        
        <p class="important">
            To complete this section you need to be familiar with editing plain text scripts and configuration files and issuing commands on the command line on your chosen operating system.
        </p>

        <h2>Configure Web servers</h2>
        <p>Below are examples of how to configure Apache and Nginx web servers. However, Mlab will work with any other web server that supports PHP and URL rewriting, such as Lighttpd. The key issues is to configure it so that <a href="https://symfony.com/doc/current/setup/web_server_configuration.html">Symfony works</a> and you can access templates, components, icons and apps in the <em>{mlab_elements}</em> directory</p>

        <h3>Alternative  1: Apache configuration</h3>
        <p>To run Mlab as a virtual host Apache needs the setup outlined below. The actual file to enter this information into varies, please refer to the relevant documentation for your operating system with regards to which file to edit.</p>
        <p> Use your preferred text editor and enter the following text in the relevant configuration file.</p>
        <pre>&lt;VirtualHost *:80&gt;
    ServerName {mlab_url}
    ServerAdmin webmaster@localhost
    AliasMatch /mlab_elements/components/(.*) /{mlab_elements}/components/$1
    AliasMatch /mlab_elements/apps/(.*) /{mlab_elements}/apps/$1
    AliasMatch /mlab_elements/templates/(.*) /{mlab_elements}/templates/$1
    AliasMatch /mlab_elements/icons/(.*) /{mlab_elements}/icons/$1
    &lt;Directory /{mlab_elements}/&gt;
        Options Indexes FollowSymLinks MultiViews
        AllowOverride All
        Order allow,deny
        allow from all
        Require all granted
    &lt;/Directory&gt;
    DocumentRoot /{mlab_code}/web
    &lt;Directory /{mlab_code}/web/&gt;
        Options Indexes FollowSymLinks MultiViews
        AllowOverride None
        Order allow,deny
        allow from all
        Require all granted
        &lt;IfModule mod_rewrite.c&gt;
            RewriteEngine On
            RewriteCond %{REQUEST_FILENAME} !-f
            RewriteRule ^(.*)$ /app.php [QSA,L]
        &lt;/IfModule&gt;
    &lt;/Directory&gt;
    ErrorLog ${APACHE_LOG_DIR}/error.log
    CustomLog ${APACHE_LOG_DIR}/access.log combined
&lt;/VirtualHost&gt;</pre>

        <p>If your system supports the APACHE_LOG_DIR variable, you can use ${APACHE_LOG_DIR}/, otherwise you will need to enter the full path, for instance /var/log/apache2/.</p>

        <p><b>Restart Apache to make the changes take effect, refer to the Apache documentation for your operating system on how to do this.</b></p>

        <h3>Alternative  2: Nginx configuration</h3>
        <p>As with Apache you need to refer to the relevant nginx documentation as to which file should be edited. You need to change the server_name to match a URL that you’re using for the site.</p>

        <pre>server {
    listen  80 default_server;
    server_name  localhost  {mlab_url} 127.0.0.1;
    root /{mlab_code}/web;
    index app.php;
    ##  First try to serve mlab static files
     location / {
      try_files $uri $uri/ /app.php?$query_string;
    }
     ##  Static files in {mlab_elements}
     location /mlab_elements {
       alias /{mlab_elements};
    }
    ## mlab php requestst are passed on to the php5-fpm socket 
     location ~ [^/]\.php(/|$) {
      fastcgi_split_path_info ^(.+\.php)(/.+)$;
      fastcgi_pass unix:/var/run/php5-fpm.sock;
      fastcgi_index index.php;
       include fastcgi_params;
      fastcgi_param PATH_INFO    $fastcgi_path_info;
      fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
      }
}</pre>

        <p>In addition, you should set in /etc/php5/fpm/php.ini cgi.fix_pathinfo = 0 </p>
        <p><b>Restart nginx to make the changes take effect, refer to nginx documentation for your operating system on how to do this.</b></p>

<!--version_mysql-->
        <h2>Configure database server</h2>
        <p>Different database servers will require different settings, not all directly related to Mlab. The only thing we want to emphasise here is the need to enable UTF-8, this enables the use of non-ASCII characters in Mlab, without this it will not work correctly. Setting UTF8 defaults for MySQL is as simple as adding a few lines to your configuration file (typically my.cnf in /etc/mysql/ on Mac/Linux/Unix variants, otherwise my.cnf inside the MySQL folder on Windows).</p>
        <p>Update (or add) the following settings:</p>
        <pre>[mysqld]<br>collation-server = utf8_general_ci<br>character-set-server = utf8</pre>
<!--/version_mysql-->


<!--timezone_php_ini-->
<!--url_allowed_php_ini-->
        <h2>Configuring PHP</h2>
        <p>Symfony, the main framework used by Mlab, requires that the option date.timezone is set in your php.ini file(s). Open the {%php.ini%} file using your favorite text editor and search for the line containing date.timezone.  Uncomment the directive by removing the ; (semicolon) sign in the beginning of the line,  and add the <a href="http://php.net/manual/en/timezones.php">appropriate timezone</a>, for your application. For example Europe/Oslo.</p>
        <pre>[Date]</pre>
        <pre>; Defines the default timezone used by the date functions</pre>
        <pre>; http://php.net/date.timezone</pre>
        <pre>date.timezone = Europe/Oslo&nbsp;</pre>
        <p><b>If you run php-fpm (and not php-cgi) you MUST restart the hardware server when you do a change! It is not enough to just restart the web server or PHP software.</b></p>
<!--/url_allowed_php_ini-->
<!--/timezone_php_ini-->

<!--python-->
        <h2>Configure PPT/DOC importer</h2>
        <p>The {mlab_code}/FileManagement/conv/config.json file has a setting that needs to be updated if you want to use a different installation of the <em>Unoconv</em> software than the one included with Mlab. The default settings is "./" which indicates that the included version should be used. The setting is shown below and can be edited using your preferred text editor.</p>
<pre>"paths": {
    "unoconv": "./"
}</pre>
<!--/python-->
        <h2>Start Mlab web-sockets messaging</h2>
        <p>Mlab uses web-sockets to exchange messages between the Mlab editing tool and the app compilation and app market services. Run the following command to start it: </p>
        <pre>cd {mlab_folder}/_minimal_websocket<br>npm start</pre>
        <p>The server configuration should be updated so that this Websocket server always starts when the server is rebooted, alternatively you should have a script that starts this at the same time as you start the main Mlab server. Refer to your OS documentation to find out how you create a service and how you can start this service whenever the computer is rebooted.</p>

        <h1>Complete the Mlab installation </h1>
        
        <p>You can now open the installation check page, open a web browser and go to http://{mlab_url}/INSTALL/index.php. Replace {mlab_url} with the URL you set up earlier in the step entitled "Specify host & domain name, test web server". Then follow the instructions on your screen.</p>

<!--import_empty_database-->
        <h2 >Prepare the Mlab database</h2>
        <p>The database must be set up before Mlab works. You need to create the database and a database user, then you need to populate the new database with some data before you can use Mlab.</p>
        <p><b>In all the commands below replace the various placeholders, such as "{mlab_database}" with values that matches your setup.</b></p>
        <p>First we create a database and a user for that database from the command line:</p>
        <pre>mysqladmin -u root -p create {mlab_database}</pre>
        <pre>mysql -u root -p -e "GRANT ALL PRIVILEGES ON mlab.* TO '{mlab_database}'@'localhost' IDENTIFIED BY '{mlab_db_password}'; FLUSH PRIVILEGES;"</pre>
        <p>Next we need to upload the table defisitions and basic login data data into the new database.</p>
        <pre>mysql -u root -p mlab &lt; /{mlab_code}/web/INSTALL/mlab.sql</pre>
        <p>Both databases contains a user with "superadmin" credentials, the initial login is &quot;admin@mlab.domain&quot; with password &quot;mlab_password&quot;. Use this to add your own super admin user and delete the default user, or at the very least change the password for the default user.</p>
<!--/import_empty_database-->
        

<!--parameters-->
        <h2>Edit parameters.yml, clear the cache and set directory permissions</h2>
        <p>The Composer installer should have created a parameters.yml in the /app/config directory. Edit this file according to your setup, pay particular attention to paths and login/password details. The database settings must match the database you set up using MySQL earlier.</p>
        <p class="important">If you edit the parameter.yml file by hand you must ensure that all directory paths end with a trailing slash, i.e. /my/directory/ and not /my/directory</p>
        <p>Next you need to clear the cache that Symfony creates and update the access permissions for the cache and log folders (commands may need to be run as administrator/root user):</p>
        <br>
        <div class="tab">
            <button class="tablinks426 defaultOpen" onclick="openTab(event, 'Debian', '426')">Ubuntu 14.04, Mac and Linux/Unix/BSD variants</button>
            <button class="tablinks426" onclick="openTab(event, 'Windows', '426')">Windows</button>
        </div>
        <div id="Debian426" class="tabcontent tabcontent426">
            <pre>php app/console cache:clear --env=prod
php app/console cache:clear --env=dev
app/console --env=prod assetic:dump
app/console --env=dev assetic:dump
sudo chown {webserveruser}:{webserveruser} {mlab_code}/app/cache -R
sudo chown {webserveruser}:{webserveruser} {mlab_code}/app/logs -R</pre>
        </div>
        <div id="Windows426" class="tabcontent tabcontent426">
            <pre>php app/console cache:clear --env=prod
php app/console cache:clear --env=dev
app/console --env=prod assetic:dump
app/console --env=dev assetic:dump
icacls "{mlab_code}/app/cache" /grant {webserveruser}:(OI)(CI)F /T
icacls "{mlab_code}/app/logs" /grant {webserveruser}:(OI)(CI)F /TR</pre>
        </div>        
<!--/parameters-->

        <h2>Preparing the Mlab app building blocks</h2>
<!--import_templates-->
        <h3>Importing Mlab templates</h3>
        <p>Templates are used to set the look and feel of an application as well as the basic navigation, thus supporting consistency across different pages in an app and across different apps. It may have headers and footers that are present on all pages and it acts as the container for components (see below) that are added to pages in apps, in effect framing the content. In addition to providing repeatable elements and formatting there is a third aspect of templates, the content check facility. The idea behind this is that there are certain "best practices" to be followed, depending on the type of app that is being created. </p>
        <p>To start using Mlab you must have at least one template installed, you should have been supplied with a ZIP file containing one or more Mlab templates. You can add these to Mlab at this point by uploading them here.</p>
<!--/import_templates-->
<!--import_components-->
        <h3>Importing Mlab components</h3>
        <p>Components can be a single HTML5 element (h1) for a headline, more advanced components that displays videos, or complex components such as multipage quizzes that store data for verification on a remote server. Components are added within the body of a template and through them an app creator can share information in a variety of ways, from simple headlines to complex map displays. Each component consist of (at minimum) an icon that is displayed in Mlab, a configuration file, a Javascript file for design time interaction with the app builder and optionally additional Javascript, CSS and HTML code to complete the component at runtime.</p>
        <p>To start using Mlab you need a few basic components. These are supplied as a a ZIP file and are part of the default Mlab installation. You can add these components to Mlab at this point by uploading them here.</p>
<!--/import_components-->


<h1>Additional tasks</h1>
<h2>Optional Mlab compiler service</h2>
<p>Refer to the <a href="https://github.com/Sinettlab/openMLAB/blob/master/DOCS/Mlab%20compiler%20service%20-%20Installation.md">installation</a> and <a href="https://github.com/Sinettlab/openMLAB/blob/master/DOCS/Mlab%20compiler%20service%20-%20API%20and%20callbacks.md">usage</a> documentation for this service if you want Mlab to compile app automatically.</p>

<h2>Debugging Mlab</h2>
<p>It is beyond the scope of this document to discuss debugging in detail, below we provide a basic list of tool that you may want to search for more information about</p>
<ul>
    <li>Xdebug for PHP</li>
    <li>Use the Symfony app_dev.php debugging tool</li>
    <li>Use inspector/debugger in your Firefox or Chrome web browser</li>
    <li>Examine the log files from Symfony, the web server, PHP and the operating system for more information when a problem occurs</li>
</ul>

    <h5 class="nocounter" style="text-align: center;">---MLAB INSTALLATION COMPLETED---</h5>
    
<script>
function openTab(evt, tabName, tabGroup) {
    var i, tabcontent, tablinks;
    tabcontent = document.getElementsByClassName("tabcontent" + tabGroup);
    for (i = 0; i < tabcontent.length; i++) {
        tabcontent[i].style.display = "none";
    }
    tablinks = document.getElementsByClassName("tablinks" + tabGroup);
    for (i = 0; i < tablinks.length; i++) {
        tablinks[i].className = tablinks[i].className.replace(" active", "");
    }
    document.getElementById(tabName + tabGroup).style.display = "block";
    evt.currentTarget.className += " active";
}

// Get the element with id="defaultOpen" and click on it
var open = document.getElementsByClassName("defaultOpen");
var x;
for (x = 0; x < open.length; x++) {
        open[x].click();
    }
</script>
<!--/body -->
</body>

</html>
